<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SmartAmazon Search - Demo with Mock Data</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        header {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 30px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        h1 {
            color: #667eea;
            font-size: 2rem;
            margin-bottom: 10px;
        }

        .tagline {
            color: #666;
            font-size: 1.1rem;
        }

        .stats {
            display: flex;
            gap: 20px;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        .stat {
            background: #f0f4ff;
            padding: 15px 25px;
            border-radius: 8px;
            font-weight: 600;
            color: #667eea;
        }

        .products-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 20px;
        }

        .product-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            position: relative;
        }

        .product-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 12px rgba(0,0,0,0.15);
        }

        .product-image {
            width: 100%;
            height: 200px;
            object-fit: cover;
            border-radius: 8px;
            margin-bottom: 15px;
            background: #f5f5f5;
        }

        .product-title {
            font-size: 0.95rem;
            font-weight: 600;
            color: #333;
            margin-bottom: 10px;
            line-height: 1.4;
            height: 60px;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .product-brand {
            color: #667eea;
            font-size: 0.85rem;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .price-section {
            margin: 15px 0;
        }

        .current-price {
            font-size: 1.8rem;
            font-weight: 700;
            color: #2d3748;
        }

        .list-price {
            text-decoration: line-through;
            color: #999;
            font-size: 0.9rem;
            margin-left: 8px;
        }

        .unit-price {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 1.1rem;
            font-weight: 700;
            display: inline-block;
            margin: 10px 0;
        }

        .badges {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
            margin: 10px 0;
        }

        .badge {
            padding: 4px 10px;
            border-radius: 4px;
            font-size: 0.75rem;
            font-weight: 600;
        }

        .badge-best {
            background: #ffd700;
            color: #000;
        }

        .badge-prime {
            background: #00a8e1;
            color: white;
        }

        .badge-discount {
            background: #ff6b6b;
            color: white;
        }

        .badge-gem {
            background: #51cf66;
            color: white;
        }

        .badge-sponsored {
            background: #ffa500;
            color: white;
            text-decoration: line-through;
        }

        .rating {
            color: #ffa500;
            font-size: 0.9rem;
            margin: 8px 0;
        }

        .reviews {
            color: #666;
            font-size: 0.85rem;
        }

        .scores {
            display: flex;
            gap: 10px;
            margin: 10px 0;
            font-size: 0.85rem;
        }

        .score {
            background: #f0f4ff;
            padding: 6px 10px;
            border-radius: 4px;
        }

        .filter-bar {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            align-items: center;
        }

        .filter-btn {
            padding: 10px 20px;
            border: 2px solid #667eea;
            background: white;
            color: #667eea;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .filter-btn:hover {
            background: #667eea;
            color: white;
        }

        .filter-btn.active {
            background: #667eea;
            color: white;
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 1.5rem;
            }

            .products-grid {
                grid-template-columns: 1fr;
            }

            .filter-bar {
                flex-direction: column;
                align-items: stretch;
            }

            .filter-btn {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üîç SmartAmazon Search</h1>
            <p class="tagline">Amazon without the BS - Find true deals with unit price comparison</p>

            <div class="stats">
                <div class="stat">üìä Total Products: <span id="total-products">10</span></div>
                <div class="stat">üö´ Sponsored Hidden: <span id="sponsored-hidden">3</span></div>
                <div class="stat">üí∞ Showing Best Unit Prices</div>
            </div>
        </header>

        <div class="filter-bar">
            <strong>Search:</strong>
            <input
                type="text"
                id="search-input"
                placeholder="Search products by name, brand..."
                style="padding: 10px 15px; border: 2px solid #667eea; border-radius: 6px; font-size: 1rem; flex: 1; min-width: 250px;"
                oninput="searchProducts(this.value)"
            />
        </div>

        <!-- Unit Price Calculator -->
        <div style="background: white; padding: 20px; border-radius: 10px; margin-bottom: 20px; box-shadow: 0 4px 6px rgba(0,0,0,0.1);">
            <h3 style="color: #667eea; margin-bottom: 15px;">üí∞ Unit Price Calculator</h3>
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                <div>
                    <label style="display: block; font-weight: 600; margin-bottom: 5px; color: #333;">Price ($)</label>
                    <input type="number" id="calc-price" value="54.99" step="0.01" style="width: 100%; padding: 8px; border: 2px solid #667eea; border-radius: 6px;" oninput="calculateUnitPrice()">
                </div>
                <div>
                    <label style="display: block; font-weight: 600; margin-bottom: 5px; color: #333;">Weight</label>
                    <input type="number" id="calc-weight" value="5" step="0.1" style="width: 100%; padding: 8px; border: 2px solid #667eea; border-radius: 6px;" oninput="calculateUnitPrice()">
                </div>
                <div>
                    <label style="display: block; font-weight: 600; margin-bottom: 5px; color: #333;">Unit</label>
                    <select id="calc-unit" style="width: 100%; padding: 8px; border: 2px solid #667eea; border-radius: 6px;" onchange="calculateUnitPrice()">
                        <option value="oz">oz (ounce)</option>
                        <option value="lb" selected>lb (pound)</option>
                        <option value="g">g (gram)</option>
                        <option value="kg">kg (kilogram)</option>
                    </select>
                </div>
                <div>
                    <label style="display: block; font-weight: 600; margin-bottom: 5px; color: #333;">Result</label>
                    <div id="calc-result" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 8px 12px; border-radius: 6px; font-size: 1.2rem; font-weight: 700; text-align: center;">
                        $0.69/oz
                    </div>
                </div>
            </div>
            <div style="margin-top: 15px; padding: 12px; background: #f0f4ff; border-radius: 6px; font-size: 0.9rem; color: #666;">
                <strong>Formula:</strong> Unit Price = Total Price √∑ (Weight √ó Conversion Factor)
                <br><span id="calc-formula" style="color: #667eea;">$54.99 √∑ (5 lb √ó 16 oz/lb) = $0.69/oz</span>
            </div>
        </div>

        <div class="filter-bar">
            <strong>Quick Filters:</strong>
            <button class="filter-btn active" id="btn-all" onclick="filterProducts('all')">All Products</button>
            <button class="filter-btn" id="btn-no-sponsored" onclick="filterProducts('no-sponsored')">Hide Sponsored</button>
            <button class="filter-btn" id="btn-prime" onclick="filterProducts('prime')">Prime Only</button>
            <button class="filter-btn" id="btn-best-value" onclick="filterProducts('best-value')">Best Value</button>
            <button class="filter-btn" onclick="sortProducts('unit-price')">Sort by $/oz</button>
            <button class="filter-btn" onclick="sortProducts('discount')">Sort by Discount</button>
        </div>

        <!-- Advanced Toggle Controls -->
        <div style="background: white; padding: 20px; border-radius: 10px; margin-bottom: 20px; box-shadow: 0 4px 6px rgba(0,0,0,0.1);">
            <h3 style="color: #667eea; margin-bottom: 15px;">üéõÔ∏è Advanced Toggles - Show/Hide Products</h3>
            <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); gap: 15px;">
                <!-- Toggle for Sponsored -->
                <label style="display: flex; align-items: center; gap: 10px; padding: 10px; background: #f0f4ff; border-radius: 6px; cursor: pointer;">
                    <input type="checkbox" id="toggle-sponsored" checked onchange="applyToggles()" style="width: 20px; height: 20px; cursor: pointer;">
                    <span style="font-weight: 600;">Show Sponsored Products</span>
                </label>

                <!-- Toggle for Non-Prime -->
                <label style="display: flex; align-items: center; gap: 10px; padding: 10px; background: #f0f4ff; border-radius: 6px; cursor: pointer;">
                    <input type="checkbox" id="toggle-non-prime" checked onchange="applyToggles()" style="width: 20px; height: 20px; cursor: pointer;">
                    <span style="font-weight: 600;">Show Non-Prime Products</span>
                </label>

                <!-- Toggle for Low Ratings -->
                <label style="display: flex; align-items: center; gap: 10px; padding: 10px; background: #f0f4ff; border-radius: 6px; cursor: pointer;">
                    <input type="checkbox" id="toggle-low-rating" checked onchange="applyToggles()" style="width: 20px; height: 20px; cursor: pointer;">
                    <span style="font-weight: 600;">Show Low Ratings (&lt;4.5)</span>
                </label>

                <!-- Toggle for High Price -->
                <label style="display: flex; align-items: center; gap: 10px; padding: 10px; background: #f0f4ff; border-radius: 6px; cursor: pointer;">
                    <input type="checkbox" id="toggle-high-price" checked onchange="applyToggles()" style="width: 20px; height: 20px; cursor: pointer;">
                    <span style="font-weight: 600;">Show Expensive ($50+)</span>
                </label>

                <!-- Toggle for Vegan/Plant Based -->
                <label style="display: flex; align-items: center; gap: 10px; padding: 10px; background: #f0f4ff; border-radius: 6px; cursor: pointer;">
                    <input type="checkbox" id="toggle-vegan" checked onchange="applyToggles()" style="width: 20px; height: 20px; cursor: pointer;">
                    <span style="font-weight: 600;">Show Vegan/Plant Products</span>
                </label>

                <!-- Toggle for Subscribe & Save -->
                <label style="display: flex; align-items: center; gap: 10px; padding: 10px; background: #f0f4ff; border-radius: 6px; cursor: pointer;">
                    <input type="checkbox" id="toggle-subscribe" checked onchange="applyToggles()" style="width: 20px; height: 20px; cursor: pointer;">
                    <span style="font-weight: 600;">Only Subscribe & Save 10%+</span>
                </label>
            </div>
            <div style="margin-top: 15px; text-align: center;">
                <button onclick="resetToggles()" style="padding: 10px 20px; background: #667eea; color: white; border: none; border-radius: 6px; font-weight: 600; cursor: pointer;">
                    Reset All Toggles
                </button>
            </div>
        </div>

        <div class="products-grid" id="products-container">
            <!-- Products will be inserted here by JavaScript -->
        </div>
    </div>

    <script>
        // Mock product data
        const mockProducts = [
            {
                id: 1,
                asin: "B000QSO98W",
                title: "Optimum Nutrition Gold Standard 100% Whey Protein Powder",
                brand: "Optimum Nutrition",
                currentPrice: 54.99,
                listPrice: 69.99,
                unitPrice: 0.69,
                unitType: "oz",
                weight: "5 lb (80 oz)",
                discount: 21,
                rating: 4.6,
                reviews: 12403,
                isPrime: true,
                isSponsored: false,
                subscribeSave: 15,
                hiddenGemScore: 85,
                dealScore: 90,
                isBestValue: true,
                image: "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='200' height='200'%3E%3Crect fill='%23667eea' width='200' height='200'/%3E%3Ctext x='50%25' y='50%25' font-size='20' fill='white' text-anchor='middle' dy='.3em'%3EProtein Powder%3C/text%3E%3C/svg%3E"
            },
            {
                id: 2,
                asin: "B00SCO8XM0",
                title: "Dymatize ISO100 Hydrolyzed Protein Powder, Gourmet Vanilla",
                brand: "Dymatize",
                currentPrice: 44.99,
                listPrice: 54.99,
                unitPrice: 0.94,
                unitType: "oz",
                weight: "3 lb (48 oz)",
                discount: 18,
                rating: 4.5,
                reviews: 8234,
                isPrime: true,
                isSponsored: true,
                subscribeSave: 10,
                hiddenGemScore: 70,
                dealScore: 75,
                isBestValue: false,
                image: "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='200' height='200'%3E%3Crect fill='%23764ba2' width='200' height='200'/%3E%3Ctext x='50%25' y='50%25' font-size='20' fill='white' text-anchor='middle' dy='.3em'%3EProtein Powder%3C/text%3E%3C/svg%3E"
            },
            {
                id: 3,
                asin: "B001RZP6LW",
                title: "MyProtein Impact Whey Protein Powder, Chocolate Smooth",
                brand: "MyProtein",
                currentPrice: 29.99,
                listPrice: 39.99,
                unitPrice: 0.85,
                unitType: "oz",
                weight: "2.2 lb (35 oz)",
                discount: 25,
                rating: 4.4,
                reviews: 3421,
                isPrime: false,
                isSponsored: false,
                subscribeSave: 5,
                hiddenGemScore: 88,
                dealScore: 80,
                isBestValue: false,
                image: "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='200' height='200'%3E%3Crect fill='%2351cf66' width='200' height='200'/%3E%3Ctext x='50%25' y='50%25' font-size='20' fill='white' text-anchor='middle' dy='.3em'%3EProtein Powder%3C/text%3E%3C/svg%3E"
            },
            {
                id: 4,
                asin: "B002DYJ0O6",
                title: "BSN SYNTHA-6 Whey Protein Powder with Micellar Casein",
                brand: "BSN",
                currentPrice: 49.99,
                listPrice: 59.99,
                unitPrice: 0.62,
                unitType: "oz",
                weight: "5.04 lb (81 oz)",
                discount: 17,
                rating: 4.5,
                reviews: 5678,
                isPrime: true,
                isSponsored: true,
                subscribeSave: 15,
                hiddenGemScore: 75,
                dealScore: 85,
                isBestValue: true,
                image: "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='200' height='200'%3E%3Crect fill='%23ff6b6b' width='200' height='200'/%3E%3Ctext x='50%25' y='50%25' font-size='20' fill='white' text-anchor='middle' dy='.3em'%3EProtein Powder%3C/text%3E%3C/svg%3E"
            },
            {
                id: 5,
                asin: "B00I9SNL36",
                title: "MuscleTech NitroTech Whey Protein Powder Plus Isolate",
                brand: "MuscleTech",
                currentPrice: 39.99,
                listPrice: 49.99,
                unitPrice: 0.78,
                unitType: "oz",
                weight: "4 lb (64 oz)",
                discount: 20,
                rating: 4.3,
                reviews: 7890,
                isPrime: true,
                isSponsored: false,
                subscribeSave: 12,
                hiddenGemScore: 82,
                dealScore: 78,
                isBestValue: false,
                image: "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='200' height='200'%3E%3Crect fill='%23ffa500' width='200' height='200'/%3E%3Ctext x='50%25' y='50%25' font-size='20' fill='white' text-anchor='middle' dy='.3em'%3EProtein Powder%3C/text%3E%3C/svg%3E"
            },
            {
                id: 6,
                asin: "B01M16K5XV",
                title: "Isopure Zero Carb Protein Powder, 100% Whey Isolate",
                brand: "Isopure",
                currentPrice: 52.99,
                listPrice: 64.99,
                unitPrice: 1.10,
                unitType: "oz",
                weight: "3 lb (48 oz)",
                discount: 18,
                rating: 4.4,
                reviews: 4567,
                isPrime: true,
                isSponsored: true,
                subscribeSave: 10,
                hiddenGemScore: 72,
                dealScore: 73,
                isBestValue: false,
                image: "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='200' height='200'%3E%3Crect fill='%2300a8e1' width='200' height='200'/%3E%3Ctext x='50%25' y='50%25' font-size='20' fill='white' text-anchor='middle' dy='.3em'%3EProtein Powder%3C/text%3E%3C/svg%3E"
            },
            {
                id: 7,
                asin: "B07QFKMQZC",
                title: "Garden of Life Organic Plant Based Protein Powder, Vanilla",
                brand: "Garden of Life",
                currentPrice: 34.99,
                listPrice: 44.99,
                unitPrice: 0.91,
                unitType: "oz",
                weight: "2.4 lb (38 oz)",
                discount: 22,
                rating: 4.5,
                reviews: 9123,
                isPrime: true,
                isSponsored: false,
                subscribeSave: 15,
                hiddenGemScore: 86,
                dealScore: 82,
                isBestValue: false,
                image: "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='200' height='200'%3E%3Crect fill='%2351cf66' width='200' height='200'/%3E%3Ctext x='50%25' y='50%25' font-size='20' fill='white' text-anchor='middle' dy='.3em'%3EPlant Protein%3C/text%3E%3C/svg%3E"
            },
            {
                id: 8,
                asin: "B001E0D4LY",
                title: "Cellucor Cor-Performance Whey Protein Powder",
                brand: "Cellucor",
                currentPrice: 27.99,
                listPrice: 35.99,
                unitPrice: 0.87,
                unitType: "oz",
                weight: "2 lb (32 oz)",
                discount: 22,
                rating: 4.3,
                reviews: 2345,
                isPrime: true,
                isSponsored: false,
                subscribeSave: 8,
                hiddenGemScore: 79,
                dealScore: 76,
                isBestValue: false,
                image: "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='200' height='200'%3E%3Crect fill='%23667eea' width='200' height='200'/%3E%3Ctext x='50%25' y='50%25' font-size='20' fill='white' text-anchor='middle' dy='.3em'%3EProtein Powder%3C/text%3E%3C/svg%3E"
            },
            {
                id: 9,
                asin: "B0015R3A9S",
                title: "NOW Sports Whey Protein Isolate Powder, Unflavored",
                brand: "NOW Sports",
                currentPrice: 42.99,
                listPrice: 52.99,
                unitPrice: 0.67,
                unitType: "oz",
                weight: "5 lb (80 oz)",
                discount: 19,
                rating: 4.6,
                reviews: 6789,
                isPrime: false,
                isSponsored: false,
                subscribeSave: 5,
                hiddenGemScore: 90,
                dealScore: 88,
                isBestValue: true,
                image: "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='200' height='200'%3E%3Crect fill='%23ffd700' width='200' height='200'/%3E%3Ctext x='50%25' y='50%25' font-size='20' fill='white' text-anchor='middle' dy='.3em'%3EProtein Powder%3C/text%3E%3C/svg%3E"
            },
            {
                id: 10,
                asin: "B07BRHXQ3P",
                title: "Vega Sport Premium Vegan Protein Powder, Chocolate",
                brand: "Vega Sport",
                currentPrice: 38.99,
                listPrice: 49.99,
                unitPrice: 1.03,
                unitType: "oz",
                weight: "2.35 lb (38 oz)",
                discount: 22,
                rating: 4.4,
                reviews: 5432,
                isPrime: true,
                isSponsored: false,
                subscribeSave: 12,
                hiddenGemScore: 81,
                dealScore: 79,
                isBestValue: false,
                image: "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='200' height='200'%3E%3Crect fill='%2351cf66' width='200' height='200'/%3E%3Ctext x='50%25' y='50%25' font-size='20' fill='white' text-anchor='middle' dy='.3em'%3EVegan Protein%3C/text%3E%3C/svg%3E"
            }
        ];

        let currentProducts = [...mockProducts];
        let currentSearchTerm = '';

        function searchProducts(searchTerm) {
            currentSearchTerm = searchTerm.toLowerCase().trim();

            let filtered = mockProducts.filter(product => {
                const titleMatch = product.title.toLowerCase().includes(currentSearchTerm);
                const brandMatch = product.brand.toLowerCase().includes(currentSearchTerm);
                return titleMatch || brandMatch;
            });

            currentProducts = filtered;
            renderProducts(filtered);

            // Update stats
            const matchCount = filtered.length;
            console.log(`Search: "${searchTerm}" - ${matchCount} products found`);
        }

        function renderProducts(products) {
            const container = document.getElementById('products-container');

            container.innerHTML = products.map(product => `
                <div class="product-card" data-sponsored="${product.isSponsored}" data-prime="${product.isPrime}" data-best="${product.isBestValue}">
                    <img src="${product.image}" alt="${product.title}" class="product-image">

                    <div class="product-brand">${product.brand}</div>
                    <div class="product-title">${product.title}</div>

                    <div class="price-section">
                        <div style="display: flex; align-items: baseline; gap: 8px; margin-bottom: 5px;">
                            <span class="current-price">$${product.currentPrice.toFixed(2)}</span>
                            <span class="list-price">$${product.listPrice.toFixed(2)}</span>
                        </div>
                        <div style="font-size: 0.85rem; color: #51cf66; font-weight: 600;">
                            You save: $${(product.listPrice - product.currentPrice).toFixed(2)} (${product.discount}%)
                        </div>
                        <div style="font-size: 0.8rem; color: #666; margin-top: 3px;">
                            Weight: ${product.weight}
                        </div>
                    </div>

                    <div class="unit-price">$${product.unitPrice.toFixed(2)}/${product.unitType}</div>

                    <div class="badges">
                        ${product.isBestValue ? '<span class="badge badge-best">üëë BEST VALUE</span>' : ''}
                        ${product.isPrime ? '<span class="badge badge-prime">‚úì Prime</span>' : ''}
                        ${product.discount > 20 ? `<span class="badge badge-discount">${product.discount}% OFF</span>` : ''}
                        ${product.hiddenGemScore >= 85 ? '<span class="badge badge-gem">üíé Hidden Gem</span>' : ''}
                        ${product.isSponsored ? '<span class="badge badge-sponsored">Sponsored</span>' : ''}
                    </div>

                    <div class="rating">
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <span style="font-size: 1.1rem;">${'‚≠ê'.repeat(Math.floor(product.rating))}${product.rating % 1 >= 0.5 ? '¬Ω' : ''}</span>
                            <span style="font-weight: 700; font-size: 1.1rem; color: #333;">${product.rating.toFixed(1)}</span>
                        </div>
                        <span class="reviews">(${product.reviews.toLocaleString()} customer reviews)</span>
                        ${product.rating >= 4.5 ? '<div style="font-size: 0.8rem; color: #51cf66; margin-top: 3px;">‚≠ê Highly Rated</div>' : ''}
                    </div>

                    <div class="scores">
                        <span class="score">üíé Gem: ${product.hiddenGemScore}/100</span>
                        <span class="score">‚≠ê Deal: ${product.dealScore}/100</span>
                    </div>

                    ${product.subscribeSave > 0 ? `<div style="font-size: 0.85rem; color: #667eea; margin-top: 10px;">üì¶ Subscribe & Save ${product.subscribeSave}%</div>` : ''}
                </div>
            `).join('');

            // Update stats
            const sponsored = products.filter(p => p.isSponsored).length;
            document.getElementById('total-products').textContent = products.length;
            document.getElementById('sponsored-hidden').textContent = sponsored;
        }

        function filterProducts(filter) {
            // Update active button
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');

            let filtered = [...mockProducts];

            switch(filter) {
                case 'no-sponsored':
                    filtered = filtered.filter(p => !p.isSponsored);
                    break;
                case 'prime':
                    filtered = filtered.filter(p => p.isPrime);
                    break;
                case 'best-value':
                    filtered = filtered.filter(p => p.isBestValue);
                    break;
                case 'all':
                default:
                    // Show all
                    break;
            }

            currentProducts = filtered;
            renderProducts(filtered);
        }

        function sortProducts(sortType) {
            let sorted = [...currentProducts];

            switch(sortType) {
                case 'unit-price':
                    sorted.sort((a, b) => a.unitPrice - b.unitPrice);
                    break;
                case 'discount':
                    sorted.sort((a, b) => b.discount - a.discount);
                    break;
            }

            renderProducts(sorted);
        }

        // Advanced Toggle Functions
        function applyToggles() {
            const showSponsored = document.getElementById('toggle-sponsored').checked;
            const showNonPrime = document.getElementById('toggle-non-prime').checked;
            const showLowRating = document.getElementById('toggle-low-rating').checked;
            const showHighPrice = document.getElementById('toggle-high-price').checked;
            const showVegan = document.getElementById('toggle-vegan').checked;
            const requireSubscribe = document.getElementById('toggle-subscribe').checked;

            let filtered = mockProducts.filter(product => {
                // Apply search filter first
                if (currentSearchTerm) {
                    const titleMatch = product.title.toLowerCase().includes(currentSearchTerm);
                    const brandMatch = product.brand.toLowerCase().includes(currentSearchTerm);
                    if (!titleMatch && !brandMatch) return false;
                }

                // Sponsored toggle
                if (!showSponsored && product.isSponsored) return false;

                // Non-Prime toggle
                if (!showNonPrime && !product.isPrime) return false;

                // Low rating toggle
                if (!showLowRating && product.rating < 4.5) return false;

                // High price toggle
                if (!showHighPrice && product.currentPrice >= 50) return false;

                // Vegan toggle (check if title contains "vegan" or "plant")
                const isVegan = product.title.toLowerCase().includes('vegan') ||
                               product.title.toLowerCase().includes('plant');
                if (!showVegan && isVegan) return false;

                // Subscribe & Save toggle
                if (requireSubscribe && product.subscribeSave < 10) return false;

                return true;
            });

            currentProducts = filtered;
            renderProducts(filtered);

            console.log(`Toggles applied: ${filtered.length}/${mockProducts.length} products shown`);
        }

        function resetToggles() {
            // Check all toggles
            document.getElementById('toggle-sponsored').checked = true;
            document.getElementById('toggle-non-prime').checked = true;
            document.getElementById('toggle-low-rating').checked = true;
            document.getElementById('toggle-high-price').checked = true;
            document.getElementById('toggle-vegan').checked = true;
            document.getElementById('toggle-subscribe').checked = false;

            // Clear search
            document.getElementById('search-input').value = '';
            currentSearchTerm = '';

            // Reset filter buttons
            document.querySelectorAll('.filter-btn').forEach(btn => btn.classList.remove('active'));
            document.getElementById('btn-all').classList.add('active');

            // Show all products
            currentProducts = [...mockProducts];
            renderProducts(mockProducts);

            console.log('All toggles reset - showing all products');
        }

        // Unit Price Calculator
        function calculateUnitPrice() {
            const price = parseFloat(document.getElementById('calc-price').value) || 0;
            const weight = parseFloat(document.getElementById('calc-weight').value) || 0;
            const unit = document.getElementById('calc-unit').value;

            // Conversion factors to ounces
            const conversions = {
                'oz': 1,
                'lb': 16,
                'g': 0.0353,
                'kg': 35.274
            };

            const weightInOz = weight * conversions[unit];
            const unitPrice = weight > 0 ? price / weightInOz : 0;

            // Update result display
            document.getElementById('calc-result').textContent = `$${unitPrice.toFixed(2)}/oz`;

            // Update formula explanation
            const conversionFactor = conversions[unit];
            const formulaText = weight > 0
                ? `$${price.toFixed(2)} √∑ (${weight} ${unit} √ó ${conversionFactor} oz/${unit}) = $${unitPrice.toFixed(2)}/oz`
                : 'Enter values to calculate';
            document.getElementById('calc-formula').textContent = formulaText;

            // Log to console for debugging
            console.log(`Unit Price Calc: $${price} for ${weight}${unit} = $${unitPrice.toFixed(2)}/oz`);
        }

        // Initial render
        renderProducts(mockProducts);

        // Initialize calculator
        calculateUnitPrice();

        // Add some console info
        console.log('SmartAmazon Demo loaded with', mockProducts.length, 'products');
        console.log('Best unit price:', Math.min(...mockProducts.map(p => p.unitPrice)).toFixed(2) + '/oz');
        console.log('Unit Price Calculator ready - try different weights and units!');
    </script>
</body>
</html>
